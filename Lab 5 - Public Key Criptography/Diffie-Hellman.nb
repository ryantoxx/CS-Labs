(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17424,        388]
NotebookOptionsPosition[     15955,        359]
NotebookOutlinePosition[     16358,        375]
CellTagsIndexPosition[     16315,        372]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
  "p", "=", 
   "32317006071311007300153513477825163362488057133489075145884341392698068341\
362100027920563626401646854585563579353308169288290230805734726252735547424612\
457410262025279165729728627063003252634282131457669314142236542209411113486299\
916574782680342305530863490506355577122191878903327295696961297438562417412362\
372251973464026918557977679768230146253979330580152268587307611975324364674758\
554607150438968449403661304976978128542959586595975670512838521327844685229255\
045682728791137200989318739591433741758378260002780349731985520606075332341226\
03254684088120031105907484281003994966956119696956248629032338072839127039"}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "=", "2"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Prime number p = \>\"", ",", "p"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Generator = \>\"", ",", "g"}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{"100", ",", "30000"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{"100", ",", "30000"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Private key a = \>\"", ",", "a"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Private key b = \>\"", ",", "b"}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"PowerMod", "[", 
    RowBox[{"g", ",", "a", ",", "p"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"PowerMod", "[", 
    RowBox[{"g", ",", "b", ",", "p"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Public key A = \>\"", ",", "A"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Public key B = \>\"", ",", "B"}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sA", "=", 
   RowBox[{"PowerMod", "[", 
    RowBox[{"B", ",", "a", ",", "p"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sB", "=", 
   RowBox[{"PowerMod", "[", 
    RowBox[{"A", ",", "b", ",", "p"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Shared secret of Alice = \>\"", ",", "sA"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Shared secret of Bob = \>\"", ",", "sB"}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sA", "==", "sB"}], ",", 
    RowBox[{"sharedSecretMatch", "=", "sA"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"hashedKey", "=", 
   RowBox[{"Hash", "[", 
    RowBox[{"sharedSecretMatch", ",", "\"\<SHA256\>\""}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<New Key: \>\"", ",", "hashedKey"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Bit length of shared secret key: \>\"", ",", 
    RowBox[{"BitLength", "[", "hashedKey", "]"}]}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hexKey", "=", 
   RowBox[{"IntegerString", "[", 
    RowBox[{"hashedKey", ",", "16"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<New key hex:\>\"", ",", "hexKey"}], "]"}], "\n"}], "Input",
 CellChangeTimes->{{3.90871275436318*^9, 3.90871275436418*^9}, {
   3.9087127987852793`*^9, 3.908712799268876*^9}, {3.90888502230014*^9, 
   3.908885047252678*^9}, {3.9088851360268774`*^9, 3.9088851596125474`*^9}, {
   3.908886107231056*^9, 3.9088861205712705`*^9}, 
   3.9088862998178883`*^9},ExpressionUUID->"dd585425-42fc-4ca7-bc84-\
47cb9c6dec38"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Prime number p = \"\>", "\[InvisibleSpace]", 
   "32317006071311007300153513477825163362488057133489075145884341392698068341\
362100027920563626401646854585563579353308169288290230805734726252735547424612\
457410262025279165729728627063003252634282131457669314142236542209411113486299\
916574782680342305530863490506355577122191878903327295696961297438562417412362\
372251973464026918557977679768230146253979330580152268587307611975324364674758\
554607150438968449403661304976978128542959586595975670512838521327844685229255\
045682728791137200989318739591433741758378260002780349731985520606075332341226\
03254684088120031105907484281003994966956119696956248629032338072839127039"}],
  SequenceForm[
  "Prime number p = ", 
   323170060713110073001535134778251633624880571334890751458843413926980683413\
621000279205636264016468545855635793533081692882902308057347262527355474246124\
574102620252791657297286270630032526342821314576693141422365422094111134862999\
165747826803423055308634905063555771221918789033272956969612974385624174123623\
722519734640269185579776797682301462539793305801522685873076119753243646747585\
546071504389684494036613049769781285429595865959756705128385213278446852292550\
456827287911372009893187395914337417583782600027803497319855206060753323412260\
3254684088120031105907484281003994966956119696956248629032338072839127039],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908712801060683*^9, 3.9088850558577547`*^9, {3.9088851214249144`*^9, 
   3.9088851290723658`*^9}, {3.908885161744753*^9, 3.908885179520854*^9}, 
   3.9088854305126586`*^9, 3.9088858467127995`*^9, {3.9088861240717845`*^9, 
   3.908886141208643*^9}},
 CellLabel->
  "During evaluation of \
In[473]:=",ExpressionUUID->"e379b554-3512-4454-9e24-025ba67f9c81"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Generator = \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["Generator = ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908712801060683*^9, 3.9088850558577547`*^9, {3.9088851214249144`*^9, 
   3.9088851290723658`*^9}, {3.908885161744753*^9, 3.908885179520854*^9}, 
   3.9088854305126586`*^9, 3.9088858467127995`*^9, {3.9088861240717845`*^9, 
   3.908886141210642*^9}},
 CellLabel->
  "During evaluation of \
In[473]:=",ExpressionUUID->"eae2a273-e602-4db3-9eba-be35ef14373e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Private key a = \"\>", "\[InvisibleSpace]", "1222"}],
  SequenceForm["Private key a = ", 1222],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908712801060683*^9, 3.9088850558577547`*^9, {3.9088851214249144`*^9, 
   3.9088851290723658`*^9}, {3.908885161744753*^9, 3.908885179520854*^9}, 
   3.9088854305126586`*^9, 3.9088858467127995`*^9, {3.9088861240717845`*^9, 
   3.9088861412174067`*^9}},
 CellLabel->
  "During evaluation of \
In[473]:=",ExpressionUUID->"87c5acaa-c8ec-465c-8c8a-841d6f00f33b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Private key b = \"\>", "\[InvisibleSpace]", "1146"}],
  SequenceForm["Private key b = ", 1146],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908712801060683*^9, 3.9088850558577547`*^9, {3.9088851214249144`*^9, 
   3.9088851290723658`*^9}, {3.908885161744753*^9, 3.908885179520854*^9}, 
   3.9088854305126586`*^9, 3.9088858467127995`*^9, {3.9088861240717845`*^9, 
   3.9088861412184057`*^9}},
 CellLabel->
  "During evaluation of \
In[473]:=",ExpressionUUID->"01f19e18-45a4-4f1b-8e93-ad168da81eb1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Public key A = \"\>", "\[InvisibleSpace]", 
   "72219537257836579360362474540064353219321212679534421933485402111976892284\
238018618421346984467297408799718691179432615508012914875581484603766409297568\
590073574734049180609175658136428693653286421390434161106464198238133103322492\
399329261717188107398221120251319010894658471829051335532283390160966088390841\
673293218536962464321440130033944094209783432892955234402304"}],
  SequenceForm[
  "Public key A = ", 
   722195372578365793603624745400643532193212126795344219334854021119768922842\
380186184213469844672974087997186911794326155080129148755814846037664092975685\
900735747340491806091756581364286936532864213904341611064641982381331033224923\
993292617171881073982211202513190108946584718290513355322833901609660883908416\
73293218536962464321440130033944094209783432892955234402304],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908712801060683*^9, 3.9088850558577547`*^9, {3.9088851214249144`*^9, 
   3.9088851290723658`*^9}, {3.908885161744753*^9, 3.908885179520854*^9}, 
   3.9088854305126586`*^9, 3.9088858467127995`*^9, {3.9088861240717845`*^9, 
   3.908886141219405*^9}},
 CellLabel->
  "During evaluation of \
In[473]:=",ExpressionUUID->"2e7b10b0-c639-456d-9de0-384272a08065"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Public key B = \"\>", "\[InvisibleSpace]", 
   "95581761707573546050050615186258948139274708974126248515930308704562027806\
393684877791974903371830925493507041989857885225717200554743985391146276390954\
102634475739017938471957984036245337428749393832518971606128262684028241927654\
045387706494218785695156003077929318549413754067993206247051633919640511308535\
2284893263039738510595600147141361664"}],
  SequenceForm[
  "Public key B = ", 
   955817617075735460500506151862589481392747089741262485159303087045620278063\
936848777919749033718309254935070419898578852257172005547439853911462763909541\
026344757390179384719579840362453374287493938325189716061282626840282419276540\
453877064942187856951560030779293185494137540679932062470516339196405113085352\
284893263039738510595600147141361664],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908712801060683*^9, 3.9088850558577547`*^9, {3.9088851214249144`*^9, 
   3.9088851290723658`*^9}, {3.908885161744753*^9, 3.908885179520854*^9}, 
   3.9088854305126586`*^9, 3.9088858467127995`*^9, {3.9088861240717845`*^9, 
   3.908886141220409*^9}},
 CellLabel->
  "During evaluation of \
In[473]:=",ExpressionUUID->"e0cf4696-1d57-4838-8fe8-a98132dbc276"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Shared secret of Alice = \"\>", "\[InvisibleSpace]", 
   "92381502590817486905607385098410939611599387152794240345416548343477058808\
301146143379055967001762331610610737625737172798289787828150908026111763605897\
727633145953955402426134770565744771546157763826244694299268510707431990712578\
441966184758053857732166135653901631116082058247942097598102343429607842186104\
418302181404593060581828060109962389205553284675895276194803283222567775429504\
231149098071761133778464229061291118175759507616494221786892175515256712095333\
724879528362808479711956044128865710891904999134979724871114641746057647315962\
904795635464139065235598283994988986365598744099908493060911345108772193"}],
  SequenceForm[
  "Shared secret of Alice = ", 
   923815025908174869056073850984109396115993871527942403454165483434770588083\
011461433790559670017623316106107376257371727982897878281509080261117636058977\
276331459539554024261347705657447715461577638262446942992685107074319907125784\
419661847580538577321661356539016311160820582479420975981023434296078421861044\
183021814045930605818280601099623892055532846758952761948032832225677754295042\
311490980717611337784642290612911181757595076164942217868921755152567120953337\
248795283628084797119560441288657108919049991349797248711146417460576473159629\
04795635464139065235598283994988986365598744099908493060911345108772193],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908712801060683*^9, 3.9088850558577547`*^9, {3.9088851214249144`*^9, 
   3.9088851290723658`*^9}, {3.908885161744753*^9, 3.908885179520854*^9}, 
   3.9088854305126586`*^9, 3.9088858467127995`*^9, {3.9088861240717845`*^9, 
   3.9088861412224092`*^9}},
 CellLabel->
  "During evaluation of \
In[473]:=",ExpressionUUID->"736ecefc-ad47-431e-8443-706773872be6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Shared secret of Bob = \"\>", "\[InvisibleSpace]", 
   "92381502590817486905607385098410939611599387152794240345416548343477058808\
301146143379055967001762331610610737625737172798289787828150908026111763605897\
727633145953955402426134770565744771546157763826244694299268510707431990712578\
441966184758053857732166135653901631116082058247942097598102343429607842186104\
418302181404593060581828060109962389205553284675895276194803283222567775429504\
231149098071761133778464229061291118175759507616494221786892175515256712095333\
724879528362808479711956044128865710891904999134979724871114641746057647315962\
904795635464139065235598283994988986365598744099908493060911345108772193"}],
  SequenceForm[
  "Shared secret of Bob = ", 
   923815025908174869056073850984109396115993871527942403454165483434770588083\
011461433790559670017623316106107376257371727982897878281509080261117636058977\
276331459539554024261347705657447715461577638262446942992685107074319907125784\
419661847580538577321661356539016311160820582479420975981023434296078421861044\
183021814045930605818280601099623892055532846758952761948032832225677754295042\
311490980717611337784642290612911181757595076164942217868921755152567120953337\
248795283628084797119560441288657108919049991349797248711146417460576473159629\
04795635464139065235598283994988986365598744099908493060911345108772193],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908712801060683*^9, 3.9088850558577547`*^9, {3.9088851214249144`*^9, 
   3.9088851290723658`*^9}, {3.908885161744753*^9, 3.908885179520854*^9}, 
   3.9088854305126586`*^9, 3.9088858467127995`*^9, {3.9088861240717845`*^9, 
   3.9088861412261033`*^9}},
 CellLabel->
  "During evaluation of \
In[473]:=",ExpressionUUID->"4b1c7476-8112-48c7-8da5-da8d3c32a485"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"New Key: \"\>", "\[InvisibleSpace]", 
   "78642694507295712814643858901431636369045777428469306772346890757253505973\
727"}],
  SequenceForm[
  "New Key: ", 
   786426945072957128146438589014316363690457774284693067723468907572535059737\
27],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908712801060683*^9, 3.9088850558577547`*^9, {3.9088851214249144`*^9, 
   3.9088851290723658`*^9}, {3.908885161744753*^9, 3.908885179520854*^9}, 
   3.9088854305126586`*^9, 3.9088858467127995`*^9, {3.9088861240717845`*^9, 
   3.9088861412272034`*^9}},
 CellLabel->
  "During evaluation of \
In[473]:=",ExpressionUUID->"bafac5a9-c01b-475b-897f-9b919dafbed2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Bit length of shared secret key: \"\>", "\[InvisibleSpace]", 
   "256"}],
  SequenceForm["Bit length of shared secret key: ", 256],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908712801060683*^9, 3.9088850558577547`*^9, {3.9088851214249144`*^9, 
   3.9088851290723658`*^9}, {3.908885161744753*^9, 3.908885179520854*^9}, 
   3.9088854305126586`*^9, 3.9088858467127995`*^9, {3.9088861240717845`*^9, 
   3.908886141229124*^9}},
 CellLabel->
  "During evaluation of \
In[473]:=",ExpressionUUID->"1846dcfd-5167-4e4c-828e-bf359e6f5ed8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"New key hex:\"\>", 
   "\[InvisibleSpace]", \
"\<\"adde300dbb1e534ceaa70fb3036caa4b2062b4192235498bdad9ff70bdfb7ddf\"\>"}],
  SequenceForm[
  "New key hex:", 
   "adde300dbb1e534ceaa70fb3036caa4b2062b4192235498bdad9ff70bdfb7ddf"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908712801060683*^9, 3.9088850558577547`*^9, {3.9088851214249144`*^9, 
   3.9088851290723658`*^9}, {3.908885161744753*^9, 3.908885179520854*^9}, 
   3.9088854305126586`*^9, 3.9088858467127995`*^9, {3.9088861240717845`*^9, 
   3.9088861412301416`*^9}},
 CellLabel->
  "During evaluation of \
In[473]:=",ExpressionUUID->"4c0f0376-85f3-435e-84af-689ffc621d59"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1070.25, 633.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"912c7982-7c0e-4327-96b9-928c007c3b26"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 3618, 94, 676, "Input",ExpressionUUID->"dd585425-42fc-4ca7-bc84-47cb9c6dec38"],
Cell[CellGroupData[{
Cell[4223, 120, 1818, 29, 110, "Print",ExpressionUUID->"e379b554-3512-4454-9e24-025ba67f9c81"],
Cell[6044, 151, 539, 12, 22, "Print",ExpressionUUID->"eae2a273-e602-4db3-9eba-be35ef14373e"],
Cell[6586, 165, 555, 12, 22, "Print",ExpressionUUID->"87c5acaa-c8ec-465c-8c8a-841d6f00f33b"],
Cell[7144, 179, 555, 12, 22, "Print",ExpressionUUID->"01f19e18-45a4-4f1b-8e93-ad168da81eb1"],
Cell[7702, 193, 1306, 23, 75, "Print",ExpressionUUID->"2e7b10b0-c639-456d-9de0-384272a08065"],
Cell[9011, 218, 1260, 23, 75, "Print",ExpressionUUID->"e0cf4696-1d57-4838-8fe8-a98132dbc276"],
Cell[10274, 243, 1832, 29, 110, "Print",ExpressionUUID->"736ecefc-ad47-431e-8443-706773872be6"],
Cell[12109, 274, 1828, 29, 110, "Print",ExpressionUUID->"4b1c7476-8112-48c7-8da5-da8d3c32a485"],
Cell[13940, 305, 702, 17, 22, "Print",ExpressionUUID->"bafac5a9-c01b-475b-897f-9b919dafbed2"],
Cell[14645, 324, 589, 13, 22, "Print",ExpressionUUID->"1846dcfd-5167-4e4c-828e-bf359e6f5ed8"],
Cell[15237, 339, 690, 16, 22, "Print",ExpressionUUID->"4c0f0376-85f3-435e-84af-689ffc621d59"]
}, Open  ]]
}, Open  ]]
}
]
*)

